{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from \"axios\";\n\nexport async function fetchImages(query, page = 1, perPage = 15) {\n    const params = new URLSearchParams({\n        page: page,\n        limit: perPage, // Corrected parameter name and value\n        key: '44464847-e125504310873b884f25bab7c', // Corrected parameter name\n        q: query.trim(), // Corrected parameter name\n        image_type: 'photo', // Corrected parameter name\n        orientation: 'horizontal', // Corrected parameter name\n        safesearch: 'true' // Corrected parameter name\n    });\n    const url = `https://pixabay.com/api/?${params}`;\n    console.log(\"Request URL:\", url);\n    try {\n        const response = await axios.get(`https://pixabay.com/api/?${params}`);\n        console.log(\"API Response:\", response.data); // Log the response\n        return response.data;\n    } catch (error) {\n        console.error(\"Failed to fetch images:\", error);\n        throw error;\n    }\n   \n}","// Описаний у документації\nimport SimpleLightbox from \"simplelightbox\";\n// Додатковий імпорт стилів\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\nexport const gallery = document.querySelector('.gallery');\nconst lightbox = new SimpleLightbox('.gallery a');\n\nexport function renderGalleryItems(images) {\n   \n    const newItems = images.map((image) => `\n        <a class= \"gallery-link\" href=\"${image.largeImageURL}\">\n            <img src=\"${image.webformatURL}\" class=\"gallery-image\" alt=\"${image.tags}\" />\n            <div class=\"info\">\n                <p>Likes: ${image.likes}</p>\n                <p>Views: ${image.views}</p>\n                <p>Comments: ${image.comments}</p>\n                <p>Downloads: ${image.downloads}</p>\n            </div>\n        </a>\n    `).join('');\n    gallery.insertAdjacentHTML('beforeend', newItems);\n    lightbox.refresh();\n}\n","\nimport { fetchImages } from './js/pixabay-api.js';\nimport { renderGalleryItems, gallery } from './js/render-functions.js';\n// Описаний у документації\nimport iziToast from \"izitoast\";\n// Додатковий імпорт стилів\nimport \"izitoast/dist/css/iziToast.min.css\";\n\nlet page = 1;\nlet perPage = 15;\nlet currentQuery = '';\nlet totalHits = 0;\nlet isFirstLoad = true; \ndocument.querySelector('.form').addEventListener('submit',async function(event) {\n    event.preventDefault();\n    const searchInput = document.querySelector('.search-input');\n    const searchQuery = searchInput.value.trim();\n    const loader = document.querySelector('.loader');\n    const loadMoreButton = document.querySelector('#loadMoreButton');\n    const totalHitsDiv = document.querySelector('#totalHits');\n    const loadingText = document.querySelector('#loadingText'); \n\n    // if (isFirstLoad) {\n    //     loader.style.display = 'block';\n    // }\n    loadingText.style.display = 'block';\n    \n    try{\n        if (!searchQuery) {\n            iziToast.error({\n                title: 'Error',\n                message: \"The search query cannot be empty. Please enter a valid query!\",\n            });\n            loader.style.display = 'none'; \n            return; \n        }\n\n        currentQuery = searchQuery;  // Зберігаємо поточний запит\n        page = 1;  // Скидаємо сторінку на 1 при новому пошуку\n        gallery.innerHTML = '';\n\n        const response = await fetchImages(currentQuery, page, perPage);\n        const images = response.hits;\n        totalHits = response.totalHits;\n\n        // setTimeout(() => {\n        //     loader.style.display = 'none';\n        //     searchInput.value = ''; \n        // }, 1000); \n        if (isFirstLoad) {\n            setTimeout(() => {\n                loader.style.display = 'none';\n                searchInput.value = '';\n            }, 1000);\n            isFirstLoad = false; // Після першого завантаження виставляємо змінну в false\n        }\n        if (!Array.isArray(images) || images.length === 0) {\n            iziToast.error({\n                title: 'Error',\n                message: \"No images found. Please try a different query!\",\n            });\n            return; \n        }\n        renderGalleryItems(images);\n        page += 1;\n        loadMoreButton.style.display = 'block';\n        totalHitsDiv.textContent = `Total images found: ${totalHits}`;\n\n    } catch(error) {\n        console.error(\"Failed to fetch images:\", error);\n        setTimeout(() => {\n            loader.style.display = 'none';\n            searchInput.value = ''; \n        }, 1000);\n        iziToast.error({\n            title: 'Error',\n            message: \"Failed to load images. Please try again!\",\n        });\n    } finally {\n        loadingText.style.display = 'none'; }\n\n});\n\ndocument.querySelector('#loadMoreButton').addEventListener('click', async function(event) {\n    event.preventDefault()\n    const loader = document.querySelector('.loader');\n    const loadMoreButton = document.querySelector('#loadMoreButton');\n    const loadingText = document.querySelector('#loadingText');\n\n    loader.style.display = 'block';\n    loadMoreButton.style.display = 'none';\n    loadingText.style.display = 'block';\n    try {\n        const response = await fetchImages(currentQuery, page, perPage);\n        const images = response.hits;\n        \n\n        if (currentQuery === 0) {\n            iziToast.error({\n                title: 'Error',\n                message: \"We're sorry, but you've reached the end of search results.\",\n            });\n            loadMoreButton.style.display = 'none';\n            return;\n        }\n        renderGalleryItems(images);\n        page += 1;  \n        const firstGalleryItem = document.querySelector('.gallery-item');\n        if (firstGalleryItem) {\n            const itemHeight = firstGalleryItem.getBoundingClientRect().height;\n            window.scrollBy({\n                top: itemHeight * 2,\n                behavior: \"smooth\",\n            });\n        }\n\n    } catch (error) {\n        setTimeout(() => {\n            loader.style.display = 'none';\n        }, 1000);\n        iziToast.error({\n            title: 'Error',\n            message: \"We're sorry, but you've reached the end of search results.\",\n        });\n    } finally {\n        setTimeout(() => {\n            loader.style.display = 'none';\n            loadMoreButton.style.display = 'block';\n            loadingText.style.display = 'none';\n        }, 1000);\n    }\n});"],"names":["fetchImages","query","page","perPage","params","url","response","axios","error","gallery","lightbox","SimpleLightbox","renderGalleryItems","images","newItems","image","currentQuery","totalHits","isFirstLoad","event","searchInput","searchQuery","loader","loadMoreButton","totalHitsDiv","loadingText","iziToast","firstGalleryItem","itemHeight"],"mappings":"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"}