{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from \"axios\";\n\nexport async function fetchImages(query, page = 1, perPage = 15) {\n    const params = new URLSearchParams({\n        page: page,\n        perPage: perPage,\n        key: '44464847-e125504310873b884f25bab7c',\n        q: query.trim(),\n        image_type: 'photo',\n        orientation: 'horizontal',\n        safesearch: 'true' \n    });\n    try {\n        const response = await axios.get(`https://pixabay.com/api/?${params}`);\n        return response.data;\n    } catch (error) {\n        console.error(\"Failed to fetch images:\", error);\n        throw error;\n    }\n   \n}","// Описаний у документації\nimport SimpleLightbox from \"simplelightbox\";\n// Додатковий імпорт стилів\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\n\nexport const gallery = document.querySelector('.gallery');\nconst lightbox = new SimpleLightbox('.gallery a');\n\nexport function renderGalleryItems(images) {\n  \n    const newItems = images.map((image) => `\n        <a class= \"gallery-link\" href=\"${image.largeImageURL}\">\n            <img src=\"${image.webformatURL}\" class=\"gallery-image\" alt=\"${image.tags}\" />\n            <div class=\"info\">\n                <p>Likes: ${image.likes}</p>\n                <p>Views: ${image.views}</p>\n                <p>Comments: ${image.comments}</p>\n                <p>Downloads: ${image.downloads}</p>\n            </div>\n        </a>\n    `).join('');\n    gallery.insertAdjacentHTML('beforeend', newItems);\n    lightbox.refresh();\n}\n","\nimport { fetchImages } from './js/pixabay-api.js';\nimport { renderGalleryItems, gallery } from './js/render-functions.js';\n// Описаний у документації\nimport iziToast from \"izitoast\";\n// Додатковий імпорт стилів\nimport \"izitoast/dist/css/iziToast.min.css\";\n\nconst searchInput = document.querySelector('.search-input');\n    const loader = document.querySelector('.loader');\n    const loadMoreButton = document.querySelector('#loadMoreButton');\n    const totalHitsDiv = document.querySelector('#totalHits');\n    const loadingText = document.querySelector('#loadingText'); \n\nlet page = 1;\nlet perPage = 15;\nlet currentQuery = '';\nlet totalHits = 0;\nlet isFirstLoad = true; \ndocument.querySelector('.form').addEventListener('submit',async function(event) {\n    event.preventDefault();\n    const searchQuery = searchInput.value.trim();\n    loadingText.style.display = 'block';\n    currentQuery = searchQuery;  \n        page = 1;\n        gallery.innerHTML = '';\n    if (!searchQuery) {\n        iziToast.error({\n            title: 'Error',\n            message: \"The search query cannot be empty. Please enter a valid query!\",\n        });\n        loader.style.display = 'none';\n        loadingText.style.display = 'none';\n        return; \n    }\n    try{\n        const response = await fetchImages(currentQuery, page, perPage);\n        const images = response.hits;\n        totalHits = response.totalHits;\n\n        if (isFirstLoad) {\n            setTimeout(() => {\n                loader.style.display = 'none';\n                loadingText.style.display = 'none';\n                searchInput.value = '';\n            }, 1000);\n            isFirstLoad = false;\n        }\n        if (!Array.isArray(images) || images.length === 0) {\n            iziToast.error({\n                title: 'Error',\n                message: \"No images found. Please try a different query!\",\n            });\n            loadMoreButton.style.display = 'none';\n            loadingText.style.display = 'none';\n            totalHitsDiv.textContent ='';\n            return; \n        }\n        renderGalleryItems(images);\n        page += 1;\n        loadMoreButton.style.display = 'block';\n        totalHitsDiv.textContent = `Total images found: ${totalHits}`;\n\n\n    } catch(error) {\n        console.error(\"Failed to fetch images:\", error);\n        iziToast.error({\n            title: 'Error',\n            message: \"Failed to load images. Please try again!\",\n        });\n        totalHitsDiv.textContent = '';\n    } \n    \n     finally {\n        loadingText.style.display = 'none'; }\n\n});\n\ndocument.querySelector('#loadMoreButton').addEventListener('click', async function(event) {\n    // event.preventDefault()\n    const loader = document.querySelector('.loader');\n    const loadMoreButton = document.querySelector('#loadMoreButton');\n    const loadingText = document.querySelector('#loadingText');\n    const totalHitsDiv = document.querySelector('#totalHits');\n    loader.style.display = 'block';\n    loadMoreButton.style.display = 'none';\n    loadingText.style.display = 'block';\n    try {\n        const response = await fetchImages(currentQuery, page, perPage);\n        const images = response.hits;\n        \n\n        if (currentQuery === 0) {\n            iziToast.error({\n                title: 'Error',\n                message: \"We're sorry, but you've reached the end of search results.\",\n            });\n            loadMoreButton.style.display = 'none';\n            loader.style.display = 'none';\n            return;\n        }\n        renderGalleryItems(images);\n        page += 1;  \n\n        const firstGalleryItem = document.querySelector('.gallery-link');\n        if (firstGalleryItem) {\n            const itemHeight = firstGalleryItem.getBoundingClientRect().height;\n            window.scrollBy({\n                top: itemHeight * 2,\n                behavior: \"smooth\",\n            });\n        }\n        if (page * perPage >= totalHits) {\n            loadMoreButton.style.display = 'none';\n            loader.style.display = 'none';\n            totalHitsDiv.textContent = '';\n            iziToast.info({\n                title: 'Info',\n                message: \"You have reached the end of the search results.\",\n            });\n        } else {\n            loadMoreButton.style.display = 'block'; \n        }\n    } catch (error) {\n        setTimeout(() => {\n            loader.style.display = 'none';\n        }, 1000);\n        iziToast.error({\n            title: 'Error',\n            message: \"We're sorry, but you've reached the end of search results.\",\n        });\n    } finally {\n        setTimeout(() => {\n            loader.style.display = 'none';\n            if (page * perPage < totalHits) {\n                loadMoreButton.style.display = 'block';\n            }\n            loadingText.style.display = 'none';\n            \n        }, 1000);\n    }\n});"],"names":["fetchImages","query","page","perPage","params","axios","error","gallery","lightbox","SimpleLightbox","renderGalleryItems","images","newItems","image","searchInput","loader","loadMoreButton","totalHitsDiv","loadingText","currentQuery","totalHits","isFirstLoad","event","searchQuery","iziToast","response","firstGalleryItem","itemHeight"],"mappings":"owBAEO,eAAeA,EAAYC,EAAOC,EAAO,EAAGC,EAAU,GAAI,CAC7D,MAAMC,EAAS,IAAI,gBAAgB,CAC/B,KAAMF,EACN,QAASC,EACT,IAAK,qCACL,EAAGF,EAAM,KAAM,EACf,WAAY,QACZ,YAAa,aACb,WAAY,MACpB,CAAK,EACD,GAAI,CAEA,OADiB,MAAMI,EAAM,IAAI,4BAA4BD,CAAM,EAAE,GACrD,IACnB,OAAQE,EAAO,CACZ,cAAQ,MAAM,0BAA2BA,CAAK,EACxCA,CACT,CAEL,CCfO,MAAMC,EAAU,SAAS,cAAc,UAAU,EAClDC,EAAW,IAAIC,EAAe,YAAY,EAEzC,SAASC,EAAmBC,EAAQ,CAEvC,MAAMC,EAAWD,EAAO,IAAKE,GAAU;AAAA,yCACFA,EAAM,aAAa;AAAA,wBACpCA,EAAM,YAAY,gCAAgCA,EAAM,IAAI;AAAA;AAAA,4BAExDA,EAAM,KAAK;AAAA,4BACXA,EAAM,KAAK;AAAA,+BACRA,EAAM,QAAQ;AAAA,gCACbA,EAAM,SAAS;AAAA;AAAA;AAAA,KAG1C,EAAE,KAAK,EAAE,EACVN,EAAQ,mBAAmB,YAAaK,CAAQ,EAChDJ,EAAS,QAAO,CACpB,CCfA,MAAMM,EAAc,SAAS,cAAc,eAAe,EAChDC,EAAS,SAAS,cAAc,SAAS,EACzCC,EAAiB,SAAS,cAAc,iBAAiB,EACzDC,EAAe,SAAS,cAAc,YAAY,EAClDC,EAAc,SAAS,cAAc,cAAc,EAE7D,IAAIhB,EAAO,EACPC,EAAU,GACVgB,EAAe,GACfC,EAAY,EACZC,EAAc,GAClB,SAAS,cAAc,OAAO,EAAE,iBAAiB,SAAS,eAAeC,EAAO,CAC5EA,EAAM,eAAc,EACpB,MAAMC,EAAcT,EAAY,MAAM,KAAI,EAK1C,GAJAI,EAAY,MAAM,QAAU,QAC5BC,EAAeI,EACXrB,EAAO,EACPK,EAAQ,UAAY,GACpB,CAACgB,EAAa,CACdC,EAAS,MAAM,CACX,MAAO,QACP,QAAS,+DACrB,CAAS,EACDT,EAAO,MAAM,QAAU,OACvBG,EAAY,MAAM,QAAU,OAC5B,MACH,CACD,GAAG,CACC,MAAMO,EAAW,MAAMzB,EAAYmB,EAAcjB,EAAMC,CAAO,EACxDQ,EAASc,EAAS,KAWxB,GAVAL,EAAYK,EAAS,UAEjBJ,IACA,WAAW,IAAM,CACbN,EAAO,MAAM,QAAU,OACvBG,EAAY,MAAM,QAAU,OAC5BJ,EAAY,MAAQ,EACvB,EAAE,GAAI,EACPO,EAAc,IAEd,CAAC,MAAM,QAAQV,CAAM,GAAKA,EAAO,SAAW,EAAG,CAC/Ca,EAAS,MAAM,CACX,MAAO,QACP,QAAS,gDACzB,CAAa,EACDR,EAAe,MAAM,QAAU,OAC/BE,EAAY,MAAM,QAAU,OAC5BD,EAAa,YAAa,GAC1B,MACH,CACDP,EAAmBC,CAAM,EACzBT,GAAQ,EACRc,EAAe,MAAM,QAAU,QAC/BC,EAAa,YAAc,uBAAuBG,CAAS,EAG9D,OAAOd,EAAO,CACX,QAAQ,MAAM,0BAA2BA,CAAK,EAC9CkB,EAAS,MAAM,CACX,MAAO,QACP,QAAS,0CACrB,CAAS,EACDP,EAAa,YAAc,EAC9B,QAEQ,CACLC,EAAY,MAAM,QAAU,MAAS,CAE7C,CAAC,EAED,SAAS,cAAc,iBAAiB,EAAE,iBAAiB,QAAS,eAAeI,EAAO,CAEtF,MAAMP,EAAS,SAAS,cAAc,SAAS,EACzCC,EAAiB,SAAS,cAAc,iBAAiB,EACzDE,EAAc,SAAS,cAAc,cAAc,EACnDD,EAAe,SAAS,cAAc,YAAY,EACxDF,EAAO,MAAM,QAAU,QACvBC,EAAe,MAAM,QAAU,OAC/BE,EAAY,MAAM,QAAU,QAC5B,GAAI,CAEA,MAAMP,GADW,MAAMX,EAAYmB,EAAcjB,EAAMC,CAAO,GACtC,KAGxB,GAAIgB,IAAiB,EAAG,CACpBK,EAAS,MAAM,CACX,MAAO,QACP,QAAS,4DACzB,CAAa,EACDR,EAAe,MAAM,QAAU,OAC/BD,EAAO,MAAM,QAAU,OACvB,MACH,CACDL,EAAmBC,CAAM,EACzBT,GAAQ,EAER,MAAMwB,EAAmB,SAAS,cAAc,eAAe,EAC/D,GAAIA,EAAkB,CAClB,MAAMC,EAAaD,EAAiB,sBAAqB,EAAG,OAC5D,OAAO,SAAS,CACZ,IAAKC,EAAa,EAClB,SAAU,QAC1B,CAAa,CACJ,CACGzB,EAAOC,GAAWiB,GAClBJ,EAAe,MAAM,QAAU,OAC/BD,EAAO,MAAM,QAAU,OACvBE,EAAa,YAAc,GAC3BO,EAAS,KAAK,CACV,MAAO,OACP,QAAS,iDACzB,CAAa,GAEDR,EAAe,MAAM,QAAU,OAEtC,MAAe,CACZ,WAAW,IAAM,CACbD,EAAO,MAAM,QAAU,MAC1B,EAAE,GAAI,EACPS,EAAS,MAAM,CACX,MAAO,QACP,QAAS,4DACrB,CAAS,CACT,QAAc,CACN,WAAW,IAAM,CACbT,EAAO,MAAM,QAAU,OACnBb,EAAOC,EAAUiB,IACjBJ,EAAe,MAAM,QAAU,SAEnCE,EAAY,MAAM,QAAU,MAE/B,EAAE,GAAI,CACV,CACL,CAAC"}